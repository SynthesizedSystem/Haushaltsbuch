<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="Haushaltsbuch.View.NewTransactionView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Haushaltsbuch.View"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:converters="using:Haushaltsbuch.Converter"
    mc:Ignorable="d">

    <UserControl.Resources>
        <converters:TransactionTypeToBoolConverter x:Key="TransactionTypeToBoolConverter" />
    </UserControl.Resources>

    <Grid>
        <StackPanel Spacing="10">

            <!-- Block Header -->
            <TextBlock Text="Neue Transaktion" FontWeight="SemiBold" FontSize="16" />

            <!-- Money input -->
            <StackPanel Spacing="2">
                <TextBlock Text="Betrag (€)" Style="{StaticResource LabelStyle}" />
                <TextBox Text="{Binding NewTransactionAmount, Mode=TwoWay}" />
            </StackPanel>

            <!-- Category and Type row -->
            <controls:UniformGrid Columns="2" ColumnSpacing="10">
                
                <!-- Category button -->
                <StackPanel Spacing="2">
                    <TextBlock Text="Kategorie" Style="{StaticResource LabelStyle}" />

                    <!-- DropDownButton with Categories -->
                    <DropDownButton Content="{Binding SelectedCategory.Name}" Style="{StaticResource DropDownButtonStyle}">
                        <DropDownButton.Flyout>
                            <Flyout x:Name="CategorySelectionFlyout" Placement="Bottom">
                                <ListView MaxHeight="150" ItemsSource="{Binding Categories}" SelectedItem="{Binding SelectedCategory, Mode=TwoWay}">
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Name}" Style="{StaticResource LabelStyle}" />
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                            </Flyout>
                        </DropDownButton.Flyout>
                    </DropDownButton>
                </StackPanel>

                <!-- Type switch -->
                <StackPanel Spacing="2">
                    <TextBlock Text="Typ" Style="{StaticResource LabelStyle}" />
                    <controls:UniformGrid Columns="2" ColumnSpacing="5">

                        <ToggleButton Content="Ausgabe" IsChecked="{Binding TransactionType, Mode=TwoWay, Converter={StaticResource TransactionTypeToBoolConverter}}" Style="{StaticResource ToggleButtonStyle}" />
                        <ToggleButton Content="Einkommen" IsChecked="{Binding TransactionType, Mode=TwoWay, Converter={StaticResource TransactionTypeToBoolConverter}, ConverterParameter=Invert}" Style="{StaticResource ToggleButtonStyle}" />
                    
                    </controls:UniformGrid>
                </StackPanel>
            </controls:UniformGrid>

            <Button Content="+ Hinzufügen" Background="#27ae60" Style="{StaticResource ButtonStyle}" Command="{Binding NewTransactionCommand}"/>

        </StackPanel>
    </Grid>
</UserControl>
